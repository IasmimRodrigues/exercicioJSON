<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <div id="mostrar"></div>

    <input type="button" value="Listar estados" onclick="mostrarEstados()" />

    <input
      type="button"
      value="Agrupar por região"
      onclick="agruparEstados()"
    />

    <label for="uf">UF:</label>
    <input type="text" placeholder="Digite a UF" id="uf" />
    <button onclick="nomeEstado()">Buscar estado</button>

    <!-- <script src="index.js"></script> -->

    <script>
      async function buscarJSON() {
        const response = await fetch(
          "https://servicodados.ibge.gov.br/api/v1/localidades/estados"
        );

        const names = await response.json();
        return names;
      }

      async function mostrarEstados() {
        let divMostrar = document.getElementById("mostrar");
        let dados = await buscarJSON();

        dados.map((estado) => {
          divMostrar.innerHTML += `<li> ${estado.nome}</li>`;
        });
      }

      async function agruparEstados() {
        let divMostrar = document.getElementById("mostrar");
        let dados = await buscarJSON();
        let regioesEstados = new Map();

        dados.forEach((estado) => {
          let regiao = estado.regiao.nome;
          if (!regioesEstados.has(regiao)) {
            regioesEstados.set(regiao, []);
          }
          regioesEstados.get(regiao).push(estado);
        });

        regioesEstados.forEach((estados, regiao) => {
          let estadosRegioes = estados.map((estado) => estado.nome);
          divMostrar.innerHTML += `<p><b>${regiao}:</b> ${estadosRegioes}<p>`;
        });
      }

      async function nomeEstado() {
        let uf = document.getElementById("uf").value.toUpperCase();
        
        if (uf.length !== 2) {
          alert("UF inválida!");
          return;
        }

        let ufs = await buscarJSON();
        let estado = ufs.find((estado) => estado.sigla === uf);
        let mostrarDiv = document.getElementById("mostrar");
        mostrarDiv.innerHTML = estado.nome;
      }
    </script>
  </body>
</html>
